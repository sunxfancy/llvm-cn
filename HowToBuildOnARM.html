
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="zh_CN">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>How To Build On ARM &mdash; LLVM 3.8 文档</title>
    
    <link rel="stylesheet" href="_static/llvm-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '3.8',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <link rel="top" title="LLVM 3.8 文档" href="index.html" />
    <link rel="next" title="How To Cross-Compile Clang/LLVM using Clang/LLVM" href="HowToCrossCompileLLVM.html" />
    <link rel="prev" title="Building LLVM with CMake" href="CMake.html" />
<style type="text/css">
  table.right { float: right; margin-left: 20px; }
  table.right td { border: 1px solid #ccc; }
</style>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-78144609-1', 'auto');
  ga('send', 'pageview');
</script>

  </head>
  <body role="document">
<div class="logo">
  <a href="index.html">
    <img src="_static/logo.png"
         alt="LLVM Logo" width="250" height="88"/></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="总目录"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="HowToCrossCompileLLVM.html" title="How To Cross-Compile Clang/LLVM using Clang/LLVM"
             accesskey="N">下一页</a> |</li>
        <li class="right" >
          <a href="CMake.html" title="Building LLVM with CMake"
             accesskey="P">上一页</a> |</li>
  <li><a href="http://llvm.org/">LLVM 官网</a>&nbsp;|&nbsp;</li>
  <li><a href="index.html">LLVM 中文文档</a>&raquo;</li>
 
      </ul>
    </div>


    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <div class="section" id="how-to-build-on-arm">
<h1>How To Build On ARM<a class="headerlink" href="#how-to-build-on-arm" title="永久链接至标题">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="永久链接至标题">¶</a></h2>
<p>This document contains information about building/testing LLVM and
Clang on an ARM machine.</p>
<p>This document is <em>NOT</em> tailored to help you cross-compile LLVM/Clang
to ARM on another architecture, for example an x86_64 machine. To find
out more about cross-compiling, please check <a class="reference internal" href="HowToCrossCompileLLVM.html"><span class="doc">How To Cross-Compile Clang/LLVM using Clang/LLVM</span></a>.</p>
</div>
<div class="section" id="notes-on-building-llvm-clang-on-arm">
<h2>Notes On Building LLVM/Clang on ARM<a class="headerlink" href="#notes-on-building-llvm-clang-on-arm" title="永久链接至标题">¶</a></h2>
<p>Here are some notes on building/testing LLVM/Clang on ARM. Note that
ARM encompasses a wide variety of CPUs; this advice is primarily based
on the ARMv6 and ARMv7 architectures and may be inapplicable to older chips.</p>
<ol class="arabic">
<li><p class="first">The most popular Linaro/Ubuntu OS&#8217;s for ARM boards, e.g., the
Pandaboard, have become hard-float platforms. There are a number of
choices when using CMake. Autoconf usage is deprecated as of 3.8.</p>
<p>Building LLVM/Clang in <code class="docutils literal"><span class="pre">Relese</span></code> mode is preferred since it consumes
a lot less memory. Otherwise, the building process will very likely
fail due to insufficient memory. It&#8217;s also a lot quicker to only build
the relevant back-ends (ARM and AArch64), since it&#8217;s very unlikely that
you&#8217;ll use an ARM board to cross-compile to other arches. If you&#8217;re
running Compiler-RT tests, also include the x86 back-end, or some tests
will fail.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>cmake <span class="nv">$LLVM_SRC_DIR</span> -DCMAKE_BUILD_TYPE<span class="o">=</span>Release <span class="se">\</span>
                    -DLLVM_TARGETS_TO_BUILD<span class="o">=</span><span class="s2">&quot;ARM;X86;AArch64&quot;</span>
</pre></div>
</div>
<p>Other options you can use are:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>Use Ninja instead of Make: <span class="s2">&quot;-G Ninja&quot;</span>
Build with assertions on: <span class="s2">&quot;-DLLVM_ENABLE_ASSERTIONS=True&quot;</span>
Force Python2: <span class="s2">&quot;-DPYTHON_EXECUTABLE=/usr/bin/python2&quot;</span>
Local <span class="o">(</span>non-sudo<span class="o">)</span> install path: <span class="s2">&quot;-DCMAKE_INSTALL_PREFIX=</span><span class="nv">$HOME</span><span class="s2">/llvm/instal&quot;</span>
CPU flags: <span class="s2">&quot;DCMAKE_C_FLAGS=-mcpu=cortex-a15&quot;</span> <span class="o">(</span>same <span class="k">for</span> CXX_FLAGS<span class="o">)</span>
</pre></div>
</div>
<p>After that, just typing <code class="docutils literal"><span class="pre">make</span> <span class="pre">-jN</span></code> or <code class="docutils literal"><span class="pre">ninja</span></code> will build everything.
<code class="docutils literal"><span class="pre">make</span> <span class="pre">-jN</span> <span class="pre">check-all</span></code> or <code class="docutils literal"><span class="pre">ninja</span> <span class="pre">check-all</span></code> will run all compiler tests. For
running the test suite, please refer to <a class="reference internal" href="TestingGuide.html"><span class="doc">LLVM Testing Infrastructure Guide</span></a>.</p>
</li>
<li><p class="first">If you are building LLVM/Clang on an ARM board with 1G of memory or less,
please use <code class="docutils literal"><span class="pre">gold</span></code> rather then GNU <code class="docutils literal"><span class="pre">ld</span></code>. In any case it is probably a good
idea to set up a swap partition, too.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ sudo ln -sf /usr/bin/ld /usr/bin/ld.gold
</pre></div>
</div>
</li>
<li><p class="first">ARM development boards can be unstable and you may experience that cores
are disappearing, caches being flushed on every big.LITTLE switch, and
other similar issues.  To help ease the effect of this, set the Linux
scheduler to &#8220;performance&#8221; on <strong>all</strong> cores using this little script:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># The code below requires the package &#39;cpufrequtils&#39; to be installed.</span>
<span class="k">for</span> <span class="o">((</span><span class="nv">cpu</span><span class="o">=</span>0<span class="p">;</span> cpu&lt;<span class="sb">`</span>grep -c proc /proc/cpuinfo<span class="sb">`</span><span class="p">;</span> cpu++<span class="o">))</span><span class="p">;</span> <span class="k">do</span>
    sudo cpufreq-set -c <span class="nv">$cpu</span> -g performance
<span class="k">done</span>
</pre></div>
</div>
<p>Remember to turn that off after the build, or you may risk burning your
CPU. Most modern kernels don&#8217;t need that, so only use it if you have
problems.</p>
</li>
<li><p class="first">Running the build on SD cards is ok, but they are more prone to failures
than good quality USB sticks, and those are more prone to failures than
external hard-drives (those are also a lot faster). So, at least, you
should consider to buy a fast USB stick.  On systems with a fast eMMC,
that&#8217;s a good option too.</p>
</li>
<li><p class="first">Make sure you have a decent power supply (dozens of dollars worth) that can
provide <em>at least</em> 4 amperes, this is especially important if you use USB
devices with your board. Externally powered USB/SATA harddrives are even
better than having a good power supply.</p>
</li>
</ol>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="总目录"
             >索引</a></li>
        <li class="right" >
          <a href="HowToCrossCompileLLVM.html" title="How To Cross-Compile Clang/LLVM using Clang/LLVM"
             >下一页</a> |</li>
        <li class="right" >
          <a href="CMake.html" title="Building LLVM with CMake"
             >上一页</a> |</li>
  <li><a href="http://llvm.org/">LLVM 官网</a>&nbsp;|&nbsp;</li>
  <li><a href="index.html">LLVM 中文文档</a>&raquo;</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; 版权所有 2003-2016, LLVM Project.
      最后更新于 2016-05-22.
      由 <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1 创建。
    </div>
  </body>
</html>